<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="style.css" />
    <script type="module" src="https://www.gstatic.com/firebasejs/10.7.2/firebase-app.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/10.7.2/firebase-analytics.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/10.7.2/firebase-firestore.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <title>ICHack Project</title>
</head>
<body style="background-image:linear-gradient(15deg, #0f4667 0%, #2a6973 150%)">
<script type="module">
// Import the functions you need from the SDKs you need
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-app.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-analytics.js";
import { doc, getDoc, getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-firestore.js";

// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyDjCn2QpsXNxD7Bvdik1RngTiCds4unhbY",
  authDomain: "ichack24-d0f70.firebaseapp.com",
  projectId: "ichack24-d0f70",
  storageBucket: "ichack24-d0f70.appspot.com",
  messagingSenderId: "123364043667",
  appId: "1:123364043667:web:2e66acb178ccb95f081666",
  measurementId: "G-05KH0P1XB4"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);

// Initialize Cloud Firestore and get a reference to the service
const db = getFirestore(app);

const docRef = doc(db, "users", "test");
const docSnap = await getDoc(docRef);

document.getElementById("cardConnectTerra").addEventListener("click", connectTerra, false);

// Connect to Terra API
async function connectTerra() {
  console.log("Connecting to Terra API");
  const url = await fetch("https://cors-anywhere.herokuapp.com/https://api.tryterra.co/v2/auth/generateWidgetSession", {
    method: "POST",
    headers: {
      "accept": "application/json",
      "content-type": "application/json",
      "dev-id": "ichacktestapp-testing-Rs6Rjkzegp",
      "x-api-key": "jXhlLZRAjKlkHIx-NIUvbYO2m-NotmGk"
    },
    body: JSON.stringify({
      "reference_id": "test-username",
      "lang": "en"
    })
  }).then((res) => res.json())
    .then((data) => data.url);
  console.log("Connected, retrieving URL");
  window.location.replace(url);
}

var cardsToDisplay = 3;

if (docSnap.exists()) {
  console.log("Document data:", docSnap.data());
  if (docSnap.data().username == "ichack"){
    console.log("Cards needed:", docSnap.data().profile_number);
    cardsToDisplay = docSnap.data().profile_number;
  }
} else {
  // docSnap.data() will be undefined in this case
  console.log("No such document!");
}

/*
try {
  const docRef = await addDoc(collection(db, "users"), {
    first: "Ada",
    last: "Lovelace",
    born: 1815
  });
  console.log("Document written with ID: ", docRef.id);
} catch (e) {
  console.error("Error adding document: ", e);
}
*/

for (let i=cardsToDisplay+1; i<=5; i++){
  var cardID = "card"+i.toString();
  document.getElementById(cardID).style.display = "none";
  document.getElementById(cardID).style.visibility = "hidden";
}
</script>
<nav class="navbar bg-dark border-bottom border-body" data-bs-theme="dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">
      <img src="https://github.com/succulentfishball/test/blob/main/output-onlinepngtools.png?raw=true" alt="Logo" width="30" height="24" class="d-inline-block align-text-top">
      <text style="font-family:Verdana, Geneva, Tahoma, sans-serif;">
          ShoeSage
      </text>
    </a>
  </div>
</nav>
<section class="hero-section">
  <div class="card-grid">
    <a class="card" href="/novablast3.html" style="height: 200px;" id="card1">
      <div class="card__background" style="background-image: url('/photos/asics-novablast-3-running-shoes.jpg')"></div>
      <div class="card__content">
        <p class="card__category">Shoe Profile #1</p>
        <h3 class="card__heading">Asics Novablast 3</h3>
      </div>
    </a>
    <a class="card" href="/newbalance.html" style="height: 200px;" id="card2">
      <div class="card__background" style="background-image: url('/photos/new-balance-me565v7-running-shoes.jpg');"></div>
      <div class="card__content">
        <p class="card__category">Shoe Profile #2</p>
        <h3 class="card__heading">New Balance ME565V7</h3>
      </div>
    </li>
    <a class="card" href="/geljolt.html" style="height: 200px;" id="card3">
      <div class="card__background" style="background-image: url('/photos/asics-jolt-4.jpg')"></div>
      <div class="card__content">
        <p class="card__category">Shoe Profile #3</p>
        <h3 class="card__heading">Asics Gel-Jolt</h3>
      </div>
    </a>
    <a class="card" href="#" style="height: 200px;" id="card4">
      <div class="card__background" style="background-image: url('/photos/asics-jolt-4.jpg')"></div>
      <div class="card__content">
        <p class="card__category">Shoe Profile #4</p>
        <h3 class="card__heading">Asics Gel-Jolt</h3>
      </div>
    </a>
    <a class="card" href="#" style="height: 200px;" id="card5">
      <div class="card__background" style="background-image: url('/photos/asics-jolt-4.jpg')"></div>
      <div class="card__content">
        <p class="card__category">Shoe Profile #5</p>
        <h3 class="card__heading">Asics Gel-Jolt</h3>
      </div>
    </a>
    <a class="card" href="addprofile.html" style="height: 200px;">
      <div class="card__background" style="background-image: url('/photos/unknown-shoe.png')"></div>
      <div class="card__content">
        <p class="card__category"></p>
        <h3 class="card__heading">Add New Shoe Profile</h3>
      </div>
    </a>
    <a class="card" style="height: 200px;" id="cardConnectTerra">
      <div class="card__background" style="background-image: url('/photos/terra.jpg')"></div>
      <div class="card__content">
        <p class="card__category"></p>
        <h3 class="card__heading">Connect To Terra</h3>
      </div>
    </a>
  <div>
</section>
</body>
</html>
